踏上取经路，比抵达灵山更重要。

临时记录一些经历过的面试题

1.优化一个接口的响应速度的方式有哪些？
代码层面：
比如同步改异步；
若存在大量对象创建又销毁的过程，是否可以通过比如对象池 sync.pool 来缓解gc压力；
是否可以通过并发的形式来提升响应速度？拿哈乐数据面板重构的例子说明，原来php是同步获取的，如果一张自定义报表包含很多指标数据，那么就会导致响应时间巨长。此时可以通过goroutine并发拉取各个指标数据，再组合成一张报表。

2.有一张聊天表，包含三个字段：receiver_id,sender_id,content，写一条sql，查询A和B之间的聊天记录。
select receiver_id,sender_id,content from chat where (receiver_id = A and sender_id = B) or (receiver_id = B and sender_id = A);

3.如果我要用redis做一个排行榜，选择哪种数据类型比较合适？
可以选择 zset 来实现。key为排行榜信息，member为用户id，score存储用户积分。
用户信息(例如排行榜显示的用户名，头像等)再用string或hash存储结构。

4.接上，如果有相同积分怎么处理？
zset对于score相同的排序是按照key的字典序排的，所以如果想要实现：先完成分数的玩家排在前面 这一需求， 需要在score中加入时间信息。
比较简单的一种方式是积分乘以10的n次方，后面的n位用于存储时间信息。
由于时间小的排在前面，所以可以取一个最大时间减去当前时间：score = 积分 * 1E10 + 最大时间 - 当前时间 (为什么不把时间放在小数位？可能会丢失精度)
需要注意两点：
score支持的最大值为 9007199254740992，所以这个n需要结合具体的业务场景决定。主要考虑积分可能的最大值生成的score不会越界。
最大时间的取值：
如果排行榜是临时的，超过某个时间就不存在或不保证数据的准确性，那最大时间直接取排行榜的截止有效时间就可以，这种方式时间信息占用的位数较少，比较推荐。
如果排行榜一致存在，就取一个固定值，2050年xx这种时间占用位数较多，但是可以降低时间精度缓解一些压力，比如精确到秒，或者占用几位小数（最好测一下精度有没有影响）

5.数据库中死锁出现的条件是什么？怎么解决？
答出死锁的条件：互相持有资源并且等待对方的资源，非抢占式，循环等待
解决方式：破坏循环等待，比如超时之后主动释放自己的资源。

6.redis实现的分布式锁和etcd有什么区别？
